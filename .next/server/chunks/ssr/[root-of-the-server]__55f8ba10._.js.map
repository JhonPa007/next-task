{"version":3,"sources":["../../../../src/app/actions/user.ts","turbopack:///[project]/node_modules/openid-client/package.json","../../../../src/app/actions/chat.ts","../../../../src/app/actions/tasks.ts","../../../../src/app/actions/subtasks.ts","../../../../src/app/actions/checkins.ts","../../../../src/app/actions/goals.ts","../../../../src/app/actions/kudos.ts"],"sourcesContent":["'use server';\r\n\r\nimport { prisma } from '@/lib/prisma';\r\nimport { getServerSession } from \"next-auth/next\";\r\nimport { authOptions } from \"@/lib/auth\";\r\nimport bcrypt from \"bcryptjs\";\r\n\r\n// Obtiene el usuario real logueado a trav칠s de NextAuth\r\nexport async function getCurrentUser() {\r\n    try {\r\n        const session = await getServerSession(authOptions);\r\n\r\n        if (!session?.user?.email) {\r\n            return null;\r\n        }\r\n\r\n        const user = await prisma.user.findUnique({\r\n            where: { email: session.user.email }\r\n        });\r\n\r\n        return user;\r\n    } catch (error) {\r\n        console.error('Error fetching current user session:', error);\r\n        return null;\r\n    }\r\n}\r\n\r\n// Funci칩n para registrar nuevos usuarios\r\nexport async function registerUser(email: string, passwordRaw: string, name?: string) {\r\n    try {\r\n        // Validaci칩n b치sica\r\n        if (!email || !passwordRaw) {\r\n            return { success: false, message: 'El correo y la contrase침a son obligatorios.' };\r\n        }\r\n\r\n        // Revisar si ya existe\r\n        const existing = await prisma.user.findUnique({ where: { email } });\r\n        if (existing) {\r\n            return { success: false, message: 'Ya existe una cuenta con este correo.' };\r\n        }\r\n\r\n        // Crear hash de la contrase침a\r\n        const hashedPassword = await bcrypt.hash(passwordRaw, 10);\r\n\r\n        // Crear usuario\r\n        const user = await prisma.user.create({\r\n            data: {\r\n                email,\r\n                name: name || email.split('@')[0],\r\n                password: hashedPassword\r\n            }\r\n        });\r\n\r\n        return { success: true, message: 'Usuario creado exitosamente.' };\r\n    } catch (error: any) {\r\n        console.error('Error registrando usuario:', error);\r\n        return { success: false, message: error.message || 'Error desconocido creando el usuario.' };\r\n    }\r\n}\r\n","{\"name\":\"openid-client\",\"version\":\"5.7.1\",\"description\":\"OpenID Connect Relying Party (RP, Client) implementation for Node.js runtime, supports passportjs\",\"keywords\":[\"auth\",\"authentication\",\"basic\",\"certified\",\"client\",\"connect\",\"dynamic\",\"electron\",\"hybrid\",\"identity\",\"implicit\",\"oauth\",\"oauth2\",\"oidc\",\"openid\",\"passport\",\"relying party\",\"strategy\"],\"homepage\":\"https://github.com/panva/openid-client\",\"repository\":\"panva/openid-client\",\"funding\":{\"url\":\"https://github.com/sponsors/panva\"},\"license\":\"MIT\",\"author\":\"Filip Skokan <panva.ip@gmail.com>\",\"exports\":{\"types\":\"./types/index.d.ts\",\"import\":\"./lib/index.mjs\",\"require\":\"./lib/index.js\"},\"main\":\"./lib/index.js\",\"types\":\"./types/index.d.ts\",\"files\":[\"lib\",\"types/index.d.ts\"],\"scripts\":{\"format\":\"npx prettier --loglevel silent --write ./lib ./test ./certification ./types\",\"test\":\"mocha test/**/*.test.js\"},\"dependencies\":{\"jose\":\"^4.15.9\",\"lru-cache\":\"^6.0.0\",\"object-hash\":\"^2.2.0\",\"oidc-token-hash\":\"^5.0.3\"},\"devDependencies\":{\"@types/node\":\"^16.18.106\",\"@types/passport\":\"^1.0.16\",\"base64url\":\"^3.0.1\",\"chai\":\"^4.5.0\",\"mocha\":\"^10.7.3\",\"nock\":\"^13.5.5\",\"prettier\":\"^2.8.8\",\"readable-mock-req\":\"^0.2.2\",\"sinon\":\"^9.2.4\",\"timekeeper\":\"^2.3.1\"},\"standard-version\":{\"scripts\":{\"postchangelog\":\"sed -i '' -e 's/### \\\\[/## [/g' CHANGELOG.md\"},\"types\":[{\"type\":\"feat\",\"section\":\"Features\"},{\"type\":\"fix\",\"section\":\"Fixes\"},{\"type\":\"chore\",\"hidden\":true},{\"type\":\"docs\",\"hidden\":true},{\"type\":\"style\",\"hidden\":true},{\"type\":\"refactor\",\"section\":\"Refactor\",\"hidden\":false},{\"type\":\"perf\",\"section\":\"Performance\",\"hidden\":false},{\"type\":\"test\",\"hidden\":true}]}}","'use server';\r\n\r\nimport { prisma } from '@/lib/prisma';\r\n\r\nexport async function getOrCreateChatSession(workspaceId: string | null) {\r\n    try {\r\n        if (!workspaceId) {\r\n            // Un modo global sin workspace. Simplemente creamos una sesi칩n an칩nima (o podr칤amos buscar una sin workspaceId)\r\n            const globalSession = await prisma.chatSession.findFirst({\r\n                where: { workspaceId: null }\r\n            });\r\n            if (globalSession) return globalSession;\r\n            return await prisma.chatSession.create({ data: {} });\r\n        }\r\n\r\n        // Buscar sesi칩n activa para el workspace\r\n        let session = await prisma.chatSession.findFirst({\r\n            where: { workspaceId }\r\n        });\r\n\r\n        // Si no existe, crearla\r\n        if (!session) {\r\n            session = await prisma.chatSession.create({\r\n                data: { workspaceId }\r\n            });\r\n        }\r\n\r\n        return session;\r\n    } catch (error) {\r\n        console.error('Error getting/creating chat session:', error);\r\n        throw new Error('No se pudo obtener la sesi칩n de chat');\r\n    }\r\n}\r\n\r\nexport async function getChatHistory(sessionId: string) {\r\n    try {\r\n        const messages = await prisma.chatMessage.findMany({\r\n            where: { chatSessionId: sessionId },\r\n            orderBy: { createdAt: 'asc' }\r\n        });\r\n        return messages;\r\n    } catch (error) {\r\n        console.error('Error fetching chat history:', error);\r\n        return [];\r\n    }\r\n}\r\n\r\nexport async function saveChatMessage(sessionId: string, role: string, text: string) {\r\n    try {\r\n        const message = await prisma.chatMessage.create({\r\n            data: {\r\n                chatSessionId: sessionId,\r\n                role,\r\n                text\r\n            }\r\n        });\r\n        return message;\r\n    } catch (error) {\r\n        console.error('Error saving chat message:', error);\r\n        throw new Error('No se pudo guardar el mensaje');\r\n    }\r\n}\r\n\r\nexport async function clearChatHistory(sessionId: string) {\r\n    try {\r\n        await prisma.chatMessage.deleteMany({\r\n            where: { chatSessionId: sessionId }\r\n        });\r\n        return true;\r\n    } catch (error) {\r\n        console.error('Error clearing chat history:', error);\r\n        throw new Error('No se pudo limpiar el historial');\r\n    }\r\n}\r\n","'use server';\r\n\r\nimport { prisma } from '@/lib/prisma';\r\nimport { revalidatePath } from 'next/cache';\r\n\r\nexport async function getTasksByWorkspace(workspaceId: string) {\r\n    try {\r\n        // Obtenemos todas las tareas que est치n relacionadas a este workspace a trav칠s de TaskWorkspace\r\n        const workspaceTasks = await prisma.taskWorkspace.findMany({\r\n            where: { workspaceId },\r\n            include: {\r\n                task: {\r\n                    include: {\r\n                        assignees: {\r\n                            include: { user: true }\r\n                        },\r\n                        subtasks: {\r\n                            orderBy: { createdAt: 'asc' }\r\n                        }\r\n                    }\r\n                }\r\n            },\r\n            orderBy: { task: { createdAt: 'desc' } }\r\n        });\r\n\r\n        // Extraemos solo la entidad 'task' plana para facilitar su uso en el frontend\r\n        return workspaceTasks.map(tw => tw.task);\r\n    } catch (error) {\r\n        console.error('Error fetching tasks by workspace:', error);\r\n        return [];\r\n    }\r\n}\r\n\r\nexport async function createTask(data: {\r\n    workspaceId: string;\r\n    title: string;\r\n    status?: string;\r\n    priority?: string;\r\n    startDate?: Date | null;\r\n    dueDate?: Date | null;\r\n}) {\r\n    try {\r\n        // En Prisma, creamos la Task y creamos su relaci칩n con el Workspace en la tabla pivot (TaskWorkspace) al mismo tiempo.\r\n        const newTask = await prisma.task.create({\r\n            data: {\r\n                title: data.title,\r\n                status: data.status || 'TODO',\r\n                priority: data.priority || 'MEDIUM',\r\n                startDate: data.startDate,\r\n                dueDate: data.dueDate,\r\n                workspaces: {\r\n                    create: {\r\n                        workspaceId: data.workspaceId\r\n                    }\r\n                }\r\n            }\r\n        });\r\n\r\n        revalidatePath(`/workspace/${data.workspaceId}`);\r\n        // Volver a buscar la tarea incluyendo posibles joins (assignees)\r\n        const fullTask = await prisma.task.findUnique({\r\n            where: { id: newTask.id },\r\n            include: {\r\n                assignees: { include: { user: true } },\r\n                subtasks: { orderBy: { createdAt: 'asc' } }\r\n            }\r\n        });\r\n        return fullTask;\r\n    } catch (error) {\r\n        console.error('Error creating task:', error);\r\n        throw new Error('No se pudo crear la tarea');\r\n    }\r\n}\r\n\r\nexport async function updateTask(\r\n    taskId: string,\r\n    workspaceId: string,\r\n    data: {\r\n        title?: string;\r\n        status?: string;\r\n        priority?: string;\r\n        startDate?: Date | null;\r\n        dueDate?: Date | null;\r\n        assigneeId?: string | null;\r\n    }\r\n) {\r\n    try {\r\n        const updateData: any = { ...data };\r\n        const newAssigneeId = updateData.assigneeId;\r\n        delete updateData.assigneeId;\r\n        delete updateData.subtasks; // Eliminar el arr de subtareas si nos lo env칤an accidentalmente\r\n\r\n        // Si se nos env칤a explicitamente el assigneeId (incluyendo null para borrar)\r\n        if (newAssigneeId !== undefined) {\r\n            // Eliminar asignaciones viejas\r\n            await prisma.taskAssignee.deleteMany({\r\n                where: { taskId }\r\n            });\r\n            // Asignar el nuevo\r\n            if (newAssigneeId !== null) {\r\n                updateData.assignees = {\r\n                    create: { userId: newAssigneeId }\r\n                };\r\n            }\r\n        }\r\n\r\n        const updatedTask = await prisma.task.update({\r\n            where: { id: taskId },\r\n            data: updateData,\r\n            include: {\r\n                assignees: { include: { user: true } },\r\n                subtasks: { orderBy: { createdAt: 'asc' } }\r\n            }\r\n        });\r\n\r\n        revalidatePath(`/workspace/${workspaceId}`);\r\n        return updatedTask;\r\n    } catch (error) {\r\n        console.error('Error updating task:', error);\r\n        throw new Error('No se pudo actualizar la tarea');\r\n    }\r\n}\r\n\r\nexport async function deleteTask(taskId: string, workspaceId: string) {\r\n    try {\r\n        await prisma.task.delete({\r\n            where: { id: taskId }\r\n        });\r\n\r\n        revalidatePath(`/workspace/${workspaceId}`);\r\n        return { success: true };\r\n    } catch (error) {\r\n        console.error('Error deleting task:', error);\r\n        throw new Error('No se pudo eliminar la tarea');\r\n    }\r\n}\r\n\r\n// --- PERSONAL TASKS ACTIONS ---\r\n\r\nexport async function getPersonalTasks(userId: string) {\r\n    try {\r\n        const tasks = await prisma.task.findMany({\r\n            where: {\r\n                assignees: {\r\n                    some: { userId: userId }\r\n                }\r\n            },\r\n            include: {\r\n                assignees: { include: { user: true } },\r\n                subtasks: { orderBy: { createdAt: 'asc' } }\r\n            },\r\n            orderBy: { createdAt: 'desc' }\r\n        });\r\n        return tasks;\r\n    } catch (error) {\r\n        console.error('Error fetching personal tasks:', error);\r\n        return [];\r\n    }\r\n}\r\n\r\nexport async function createPersonalTask(userId: string, data: {\r\n    title: string;\r\n    status?: string;\r\n    priority?: string;\r\n    startDate?: Date | null;\r\n    dueDate?: Date | null;\r\n}) {\r\n    try {\r\n        const newTask = await prisma.task.create({\r\n            data: {\r\n                title: data.title,\r\n                status: data.status || 'TODO',\r\n                priority: data.priority || 'MEDIUM',\r\n                startDate: data.startDate,\r\n                dueDate: data.dueDate,\r\n                assignees: {\r\n                    create: { userId }\r\n                }\r\n            },\r\n            include: {\r\n                assignees: { include: { user: true } },\r\n                subtasks: { orderBy: { createdAt: 'asc' } }\r\n            }\r\n        });\r\n\r\n        revalidatePath(`/my-tasks`);\r\n        return newTask;\r\n    } catch (error) {\r\n        console.error('Error creating personal task:', error);\r\n        throw new Error('No se pudo crear la tarea personal');\r\n    }\r\n}\r\n\r\nexport async function updatePersonalTask(\r\n    taskId: string,\r\n    data: {\r\n        title?: string;\r\n        status?: string;\r\n        priority?: string;\r\n        startDate?: Date | null;\r\n        dueDate?: Date | null;\r\n    }\r\n) {\r\n    try {\r\n        const updateData: any = { ...data };\r\n        delete updateData.subtasks;\r\n\r\n        const updatedTask = await prisma.task.update({\r\n            where: { id: taskId },\r\n            data: updateData,\r\n            include: {\r\n                assignees: { include: { user: true } },\r\n                subtasks: { orderBy: { createdAt: 'asc' } }\r\n            }\r\n        });\r\n\r\n        revalidatePath(`/my-tasks`);\r\n        return updatedTask;\r\n    } catch (error) {\r\n        console.error('Error updating personal task:', error);\r\n        throw new Error('No se pudo actualizar la tarea personal');\r\n    }\r\n}\r\n\r\nexport async function deletePersonalTask(taskId: string) {\r\n    try {\r\n        await prisma.task.delete({\r\n            where: { id: taskId }\r\n        });\r\n\r\n        revalidatePath(`/my-tasks`);\r\n        return { success: true };\r\n    } catch (error) {\r\n        console.error('Error deleting personal task:', error);\r\n        throw new Error('No se pudo eliminar la tarea personal');\r\n    }\r\n}\r\n","'use server';\r\n\r\nimport { prisma } from '@/lib/prisma';\r\nimport { revalidatePath } from 'next/cache';\r\n\r\nexport async function createSubtask(taskId: string, workspaceId: string, title: string) {\r\n    try {\r\n        const subtask = await prisma.subtask.create({\r\n            data: {\r\n                taskId,\r\n                title,\r\n                isCompleted: false\r\n            }\r\n        });\r\n        revalidatePath(`/workspace/${workspaceId}`);\r\n        return subtask;\r\n    } catch (error) {\r\n        console.error('Error creating subtask:', error);\r\n        throw new Error('No se pudo crear la subtarea');\r\n    }\r\n}\r\n\r\nexport async function toggleSubtaskCompletion(subtaskId: string, workspaceId: string, isCompleted: boolean) {\r\n    try {\r\n        const subtask = await prisma.subtask.update({\r\n            where: { id: subtaskId },\r\n            data: { isCompleted }\r\n        });\r\n        revalidatePath(`/workspace/${workspaceId}`);\r\n        return subtask;\r\n    } catch (error) {\r\n        console.error('Error toggling subtask:', error);\r\n        throw new Error('No se pudo actualizar la subtarea');\r\n    }\r\n}\r\n\r\nexport async function updateSubtaskTitle(subtaskId: string, workspaceId: string, title: string) {\r\n    try {\r\n        const subtask = await prisma.subtask.update({\r\n            where: { id: subtaskId },\r\n            data: { title }\r\n        });\r\n        revalidatePath(`/workspace/${workspaceId}`);\r\n        return subtask;\r\n    } catch (error) {\r\n        console.error('Error updating subtask title:', error);\r\n        throw new Error('No se pudo actualizar el t칤tulo de la subtarea');\r\n    }\r\n}\r\n\r\nexport async function deleteSubtask(subtaskId: string, workspaceId: string) {\r\n    try {\r\n        await prisma.subtask.delete({\r\n            where: { id: subtaskId }\r\n        });\r\n        revalidatePath(`/workspace/${workspaceId}`);\r\n        return { success: true };\r\n    } catch (error) {\r\n        console.error('Error deleting subtask:', error);\r\n        throw new Error('No se pudo eliminar la subtarea');\r\n    }\r\n}\r\n","'use server';\r\n\r\nimport { prisma } from '@/lib/prisma';\r\nimport { getCurrentUser } from '@/app/actions/user';\r\nimport { revalidatePath } from 'next/cache';\r\n\r\n/**\r\n * Creates a new weekly 1-on-1 Check-in report for a Task\r\n */\r\nexport async function createCheckIn(taskId: string, accomplishments: string, blockers: string | null, morale: string) {\r\n    try {\r\n        const user = await getCurrentUser();\r\n        if (!user) return { success: false, error: 'Unauthorized' };\r\n\r\n        if (!accomplishments || accomplishments.trim() === '') {\r\n            return { success: false, error: 'Se requieren ingresar al menos los logros.' };\r\n        }\r\n\r\n        const checkIn = await prisma.checkIn.create({\r\n            data: {\r\n                accomplishments,\r\n                blockers,\r\n                morale,\r\n                task: { connect: { id: taskId } },\r\n                user: { connect: { id: user.id } }\r\n            }\r\n        });\r\n\r\n        // revalidatePath no es mandatoria aqu칤 si el cliente recarga optimistamente la vista de la tarea, \r\n        // pero la dejamos sin fallar usando un `findUnique` de la tarea para revalidar su workspace si hace falta.\r\n\r\n        return { success: true, data: checkIn };\r\n    } catch (error: any) {\r\n        console.error('Error creating checkin:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\n/**\r\n * Retrieves all Check-ins submitted within a given Task\r\n */\r\nexport async function getTaskCheckIns(taskId: string) {\r\n    try {\r\n        const user = await getCurrentUser();\r\n        if (!user) return { success: false, error: 'Unauthorized' };\r\n\r\n        const checkIns = await prisma.checkIn.findMany({\r\n            where: { taskId },\r\n            include: {\r\n                user: { select: { name: true, email: true } }\r\n            },\r\n            orderBy: { createdAt: 'desc' },\r\n            take: 30 // Keep the log reasonably sized\r\n        });\r\n\r\n        return { success: true, data: checkIns };\r\n    } catch (error: any) {\r\n        console.error('Error in getWorkspaceCheckIns:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n","'use server';\r\n\r\nimport { prisma } from '@/lib/prisma';\r\nimport { revalidatePath } from 'next/cache';\r\n\r\n// Obtener metas por workspace\r\nexport async function getGoalsByWorkspace(workspaceId: string) {\r\n    try {\r\n        const goals = await prisma.goal.findMany({\r\n            where: { workspaceId },\r\n            include: {\r\n                keyResults: true\r\n            },\r\n            orderBy: { createdAt: 'desc' }\r\n        });\r\n        return goals;\r\n    } catch (error) {\r\n        console.error('Error fetching goals:', error);\r\n        return [];\r\n    }\r\n}\r\n\r\n// Crear una nueva Meta (Objetivo)\r\nexport async function createGoal(data: {\r\n    workspaceId: string;\r\n    title: string;\r\n    type?: 'QUALITATIVE' | 'QUANTITATIVE' | 'HABIT';\r\n}) {\r\n    try {\r\n        const goal = await prisma.goal.create({\r\n            data: {\r\n                workspaceId: data.workspaceId,\r\n                title: data.title,\r\n                type: data.type || 'QUALITATIVE',\r\n                status: 'ON_TRACK'\r\n            }\r\n        });\r\n\r\n        revalidatePath(`/workspace/${data.workspaceId}`);\r\n        return goal;\r\n    } catch (error) {\r\n        console.error('Error creating goal:', error);\r\n        throw new Error('No se pudo crear el objetivo');\r\n    }\r\n}\r\n\r\n// Crear un Key Result (SMART)\r\nexport async function createKeyResult(data: {\r\n    goalId: string;\r\n    title: string;\r\n    targetValue: number;\r\n    unit?: string;\r\n}) {\r\n    try {\r\n        const kr = await prisma.keyResult.create({\r\n            data: {\r\n                goalId: data.goalId,\r\n                title: data.title,\r\n                targetValue: data.targetValue,\r\n                unit: data.unit,\r\n                currentValue: 0\r\n            }\r\n        });\r\n\r\n        revalidatePath('/');\r\n        return kr;\r\n    } catch (error) {\r\n        console.error('Error creating KR:', error);\r\n        throw new Error('No se pudo crear el key result');\r\n    }\r\n}\r\n\r\n// Actualizar nombre de una meta\r\nexport async function updateGoal(id: string, title: string, workspaceId: string) {\r\n    try {\r\n        const goal = await prisma.goal.update({\r\n            where: { id },\r\n            data: { title }\r\n        });\r\n        revalidatePath(`/workspace/${workspaceId}`);\r\n        return goal;\r\n    } catch (error) {\r\n        console.error('Error updating goal:', error);\r\n        throw new Error('No se pudo actualizar el objetivo');\r\n    }\r\n}\r\n\r\n// Eliminar un objetivo (Goals en Prisma con onDelete: Cascade eliminar치 sus KRs automagicamente si en el schema est치 as칤, de lo contrario lo forzamos)\r\nexport async function deleteGoal(id: string, workspaceId: string) {\r\n    try {\r\n        await prisma.goal.delete({\r\n            where: { id }\r\n        });\r\n        revalidatePath(`/workspace/${workspaceId}`);\r\n        return true;\r\n    } catch (error) {\r\n        console.error('Error deleting goal:', error);\r\n        throw new Error('No se pudo eliminar el objetivo');\r\n    }\r\n}\r\n\r\n// Actualizar un Key Result\r\nexport async function updateKeyResult(id: string, data: {\r\n    title?: string;\r\n    currentValue?: number;\r\n    targetValue?: number;\r\n    unit?: string;\r\n}) {\r\n    try {\r\n        const kr = await prisma.keyResult.update({\r\n            where: { id },\r\n            data\r\n        });\r\n        revalidatePath('/'); // Simplificado, ideal revalidar workspace path si pasamos el id\r\n        return kr;\r\n    } catch (error) {\r\n        console.error('Error updating key result:', error);\r\n        throw new Error('No se pudo actualizar el resultado clave');\r\n    }\r\n}\r\n\r\n// Eliminar un Key Result\r\nexport async function deleteKeyResult(id: string) {\r\n    try {\r\n        await prisma.keyResult.delete({\r\n            where: { id }\r\n        });\r\n        revalidatePath('/');\r\n        return true;\r\n    } catch (error) {\r\n        console.error('Error deleting key result:', error);\r\n        throw new Error('No se pudo eliminar el resultado clave');\r\n    }\r\n}\r\n","'use server';\r\n\r\nimport { prisma } from '@/lib/prisma';\r\nimport { getCurrentUser } from '@/app/actions/user';\r\nimport { revalidatePath } from 'next/cache';\r\nimport { sendNotificationToUser } from '@/app/actions/notifications';\r\n\r\n/**\r\n * Otorgar un Kudo a un integrante del proyecto\r\n */\r\nexport async function createKudo(receiverId: string, workspaceId: string | undefined, message: string) {\r\n    try {\r\n        const sender = await getCurrentUser();\r\n        if (!sender) return { success: false, error: 'Unauthorized' };\r\n\r\n        if (!message || message.trim() === '') {\r\n            return { success: false, error: 'El mensaje no puede estar vac칤o' };\r\n        }\r\n\r\n        if (sender.id === receiverId) {\r\n            return { success: false, error: 'No te puedes dar Kudos a ti mismo' };\r\n        }\r\n\r\n        const kudo = await prisma.kudo.create({\r\n            data: {\r\n                message,\r\n                points: 10,\r\n                senderId: sender.id,\r\n                receiverId,\r\n                workspaceId\r\n            }\r\n        });\r\n\r\n        // 游끥 Notificaci칩n Push Animada al Receptor\r\n        const title = `游 Kudo Recibido!`;\r\n        const body = `\"${sender.name || sender.email}\" te ha reconocido: ${message}`;\r\n        const url = workspaceId ? `/workspace/${workspaceId}` : '/my-tasks';\r\n\r\n        await sendNotificationToUser(receiverId, title, body, url);\r\n\r\n        if (workspaceId) {\r\n            revalidatePath(`/workspace/${workspaceId}`);\r\n        }\r\n        revalidatePath('/'); // Global dashboard\r\n\r\n        return { success: true, data: kudo };\r\n    } catch (error: any) {\r\n        console.error('Error creating kudo:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\n/**\r\n * Obtener todos los Kudos otorgados dentro de un Workspace espec칤fico\r\n */\r\nexport async function getWorkspaceKudos(workspaceId: string) {\r\n    try {\r\n        const kudos = await prisma.kudo.findMany({\r\n            where: { workspaceId },\r\n            include: {\r\n                sender: { select: { name: true, email: true } },\r\n                receiver: { select: { name: true, email: true } }\r\n            },\r\n            orderBy: { createdAt: 'desc' },\r\n            take: 10 // Mostrar solo los 칰ltimos 10 de forma 치gil\r\n        });\r\n\r\n        return { success: true, data: kudos };\r\n    } catch (error: any) {\r\n        console.error('Error in getWorkspaceKudos:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n\r\n/**\r\n * Obtener los Kudos globales de toda la empresa\r\n */\r\nexport async function getGlobalKudos() {\r\n    try {\r\n        const kudos = await prisma.kudo.findMany({\r\n            include: {\r\n                sender: { select: { name: true, email: true } },\r\n                receiver: { select: { name: true, email: true } },\r\n                workspace: { select: { name: true } }\r\n            },\r\n            orderBy: { createdAt: 'desc' },\r\n            take: 20\r\n        });\r\n\r\n        return { success: true, data: kudos };\r\n    } catch (error: any) {\r\n        console.error('Error in getGlobalKudos:', error);\r\n        return { success: false, error: error.message };\r\n    }\r\n}\r\n"],"names":[],"mappings":"wDAEA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,MACA,EAAA,EAAA,CAAA,CAAA,OAGO,eAAe,IAClB,GAAI,CACA,IAAM,EAAU,MAAM,CAAA,EAAA,EAAA,gBAAA,AAAgB,EAAC,EAAA,WAAW,EAElD,GAAI,CAAC,GAAS,MAAM,MAChB,CADuB,MAChB,KAOX,OAJa,AAIN,MAJY,EAAA,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC,CACtC,MAAO,CAAE,MAAO,EAAQ,IAAI,CAAC,KAAK,AAAC,CACvC,EAGJ,CAAE,MAAO,EAAO,CAEZ,OADA,QAAQ,KAAK,CAAC,uCAAwC,GAC/C,IACX,CACJ,CAGO,eAAe,EAAa,CAAa,CAAE,CAAmB,CAAE,CAAa,EAChF,GAAI,CAEA,GAAI,CAAC,GAAS,CAAC,EACX,MAAO,CAAE,IADe,KACN,EAAO,QAAS,6CAA8C,EAKpF,GADiB,CACb,KADmB,EAAA,GACT,GADe,CAAC,IAAI,CAAC,UAAU,CAAC,CAAE,MAAO,OAAE,CAAM,CAAE,GAE7D,MAAO,CAAE,SAAS,EAAO,QAAS,uCAAwC,EAI9E,IAAM,EAAiB,MAAM,EAAA,OAAM,CAAC,IAAI,CAAC,EAAa,IAWtD,OARa,MAAM,EAAA,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAClC,KAAM,CACF,QACA,KAAM,GAAQ,EAAM,KAAK,CAAC,IAAI,CAAC,EAAE,CACjC,SAAU,CACd,CACJ,GAEO,CAAE,SAAS,EAAM,QAAS,8BAA+B,CACpE,CAAE,MAAO,EAAY,CAEjB,OADA,QAAQ,KAAK,CAAC,6BAA8B,GACrC,CAAE,SAAS,EAAO,QAAS,EAAM,OAAO,EAAI,uCAAwC,CAC/F,CACJ,0CAlDsB,EAoBA,IApBA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MAoBA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,knBC5BtB,EAAA,CAAA,CAAA,CAAA,KAAA,gBAAA,QAAA,QAAA,YAAA,oGAAA,SAAA,CAAA,OAAA,iBAAA,QAAA,YAAA,SAAA,UAAA,UAAA,WAAA,SAAA,WAAA,WAAA,QAAA,SAAA,OAAA,SAAA,WAAA,gBAAA,WAAA,CAAA,SAAA,yCAAA,WAAA,sBAAA,QAAA,CAAA,IAAA,mCAAA,EAAA,QAAA,MAAA,OAAA,oCAAA,QAAA,CAAA,MAAA,qBAAA,OAAA,kBAAA,QAAA,gBAAA,EAAA,KAAA,iBAAA,MAAA,qBAAA,MAAA,CAAA,MAAA,mBAAA,CAAA,QAAA,CAAA,OAAA,8EAAA,KAAA,yBAAA,EAAA,aAAA,CAAA,KAAA,UAAA,YAAA,SAAA,cAAA,SAAA,kBAAA,QAAA,EAAA,gBAAA,CAAA,cAAA,aAAA,kBAAA,UAAA,UAAA,SAAA,KAAA,SAAA,MAAA,UAAA,KAAA,UAAA,SAAA,SAAA,oBAAA,SAAA,MAAA,SAAA,WAAA,QAAA,EAAA,mBAAA,CAAA,QAAA,CAAA,cAAA,8CAAA,EAAA,MAAA,CAAA,CAAA,KAAA,OAAA,QAAA,UAAA,EAAA,CAAA,KAAA,MAAA,QAAA,OAAA,EAAA,CAAA,KAAA,QAAA,OAAA,CAAA,CAAA,EAAA,CAAA,KAAA,OAAA,OAAA,CAAA,CAAA,EAAA,CAAA,KAAA,QAAA,OAAA,CAAA,CAAA,EAAA,CAAA,KAAA,WAAA,QAAA,WAAA,OAAA,CAAA,CAAA,EAAA,CAAA,KAAA,OAAA,QAAA,cAAA,OAAA,CAAA,CAAA,EAAA,CAAA,KAAA,OAAA,OAAA,CAAA,CAAA,EAAA,CAAA,E,0UCEA,EAAA,EAAA,CAAA,CAAA,OAEO,eAAe,EAAuB,CAA0B,EACnE,GAAI,CACA,GAAI,CAAC,EAAa,CAEd,IAAM,EAAgB,MAAM,EAAA,MAAM,CAAC,WAAW,CAAC,SAAS,CAAC,CACrD,MAAO,CAAE,YAAa,IAAK,CAC/B,GACA,GAAI,EAAe,OAAO,EAC1B,OAAO,MAAM,EAAA,MAAM,CAAC,WAAW,CAAC,MAAM,CAAC,CAAE,KAAM,CAAC,CAAE,EACtD,CAGA,IAAI,EAAU,MAAM,EAAA,MAAM,CAAC,WAAW,CAAC,SAAS,CAAC,CAC7C,MAAO,aAAE,CAAY,CACzB,GASA,OANI,AAAC,GACD,GAAU,GADA,GACM,EAAA,MAAM,CAAC,WAAW,CAAC,MAAM,CAAC,CACtC,KAAM,aAAE,CAAY,CACxB,EAAA,EAGG,CACX,CAAE,MAAO,EAAO,CAEZ,MADA,QAAQ,KAAK,CAAC,uCAAwC,GAChD,AAAI,MAAM,uCACpB,CACJ,CAEO,eAAe,EAAe,CAAiB,EAClD,GAAI,CAKA,OAJiB,AAIV,MAJgB,EAAA,MAAM,CAAC,WAAW,CAAC,QAAQ,CAAC,CAC/C,MAAO,CAAE,cAAe,CAAU,EAClC,QAAS,CAAE,UAAW,KAAM,CAChC,EAEJ,CAAE,MAAO,EAAO,CAEZ,OADA,QAAQ,KAAK,CAAC,+BAAgC,GACvC,EAAE,AACb,CACJ,CAEO,eAAe,EAAgB,CAAiB,CAAE,CAAY,CAAE,CAAY,EAC/E,GAAI,CAQA,OAAO,AAPS,MAAM,EAAA,MAAM,CAAC,WAAW,CAAC,MAAM,CAAC,CAC5C,KAAM,CACF,cAAe,OACf,OACA,CACJ,CACJ,EAEJ,CAAE,MAAO,EAAO,CAEZ,MADA,QAAQ,KAAK,CAAC,6BAA8B,GACtC,AAAI,MAAM,gCACpB,CACJ,CAEO,eAAe,EAAiB,CAAiB,EACpD,GAAI,CAIA,OAHA,MAAM,EAAA,MAAM,CAAC,WAAW,CAAC,UAAU,CAAC,CAChC,MAAO,CAAE,cAAe,CAAU,CACtC,IACO,CACX,CAAE,MAAO,EAAO,CAEZ,MADA,QAAQ,KAAK,CAAC,+BAAgC,GACxC,AAAI,MAAM,kCACpB,CACJ,0CArEsB,EA8BA,EAaA,EAgBA,IA3DA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MA8BA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MAaA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MAgBA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,qIC7DtB,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OAEO,eAAe,EAAoB,CAAmB,EACzD,GAAI,CAoBA,MAAO,CAlBgB,MAAM,EAAA,MAAM,CAAC,aAAa,CAAC,QAAQ,CAAC,CACvD,MAAO,aAAE,CAAY,EACrB,QAAS,CACL,KAAM,CACF,QAAS,CACL,UAAW,CACP,QAAS,CAAE,MAAM,CAAK,CAC1B,EACA,SAAU,CACN,QAAS,CAAE,UAAW,KAAM,CAChC,CACJ,CACJ,CACJ,EACA,QAAS,CAAE,KAAM,CAAE,UAAW,MAAO,CAAE,CAC3C,EAAA,EAGsB,GAAG,CAAC,GAAM,EAAG,IAAI,CAC3C,CAAE,MAAO,EAAO,CAEZ,OADA,QAAQ,KAAK,CAAC,qCAAsC,GAC7C,EACX,AADa,CAEjB,CAEO,eAAe,EAAW,CAOhC,EACG,GAAI,CAEA,IAAM,EAAU,MAAM,EAAA,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CACrC,KAAM,CACF,MAAO,EAAK,KAAK,CACjB,OAAQ,EAAK,MAAM,EAAI,OACvB,SAAU,EAAK,QAAQ,EAAI,SAC3B,UAAW,EAAK,SAAS,CACzB,QAAS,EAAK,OAAO,CACrB,WAAY,CACR,OAAQ,CACJ,YAAa,EAAK,WAAW,AACjC,CACJ,CACJ,CACJ,GAWA,MATA,CAAA,AASO,EATP,EAAA,cAAc,AAAd,EAAe,CAAC,WAAW,EAAE,EAAK,WAAW,CAAA,CAAE,EAE9B,MAAM,EAAA,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC,CAC1C,MAAO,CAAE,GAAI,EAAQ,EAAE,AAAC,EACxB,QAAS,CACL,UAAW,CAAE,QAAS,CAAE,MAAM,CAAK,CAAE,EACrC,SAAU,CAAE,QAAS,CAAE,UAAW,KAAM,CAAE,CAC9C,CACJ,EAEJ,CAAE,MAAO,EAAO,CAEZ,MADA,QAAQ,KAAK,CAAC,uBAAwB,GAChC,AAAI,MAAM,4BACpB,CACJ,CAEO,eAAe,EAClB,CAAc,CACd,CAAmB,CACnB,CAOC,EAED,GAAI,CACA,IAAM,EAAkB,CAAE,GAAG,CAAK,AAAD,EAC3B,EAAgB,EAAW,UAAU,AAC3C,QAAO,EAAW,UAAU,CAC5B,OAAO,EAAW,QAAQ,CAGJ,CAHM,QAGxB,EAA6B,EAE7B,MAAM,EAAA,MAAM,CAAC,YAAY,CAAC,UAAU,CAAC,CACjC,MAAO,MAN6E,EAM3E,CAAO,CACpB,GAEsB,MAAM,CAAxB,IACA,EAAW,SAAS,CAAG,CACnB,OAAQ,CAAE,OAAQ,CAAc,EACpC,GAIR,IAAM,EAAc,MAAM,EAAA,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CACzC,MAAO,CAAE,GAAI,CAAO,EACpB,KAAM,EACN,QAAS,CACL,UAAW,CAAE,QAAS,CAAE,MAAM,CAAK,CAAE,EACrC,SAAU,CAAE,QAAS,CAAE,UAAW,KAAM,CAAE,CAC9C,CACJ,GAGA,MADA,CAAA,EAAA,EAAA,cAAA,AAAc,EAAC,CAAC,WAAW,EAAE,EAAA,CAAa,EACnC,CACX,CAAE,MAAO,EAAO,CAEZ,MADA,QAAQ,KAAK,CAAC,uBAAwB,GAChC,AAAI,MAAM,iCACpB,CACJ,CAEO,eAAe,EAAW,CAAc,CAAE,CAAmB,EAChE,GAAI,CAMA,OALA,MAAM,EAAA,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CACrB,MAAO,CAAE,GAAI,CAAO,CACxB,GAEA,CAAA,EAAA,EAAA,cAAA,AAAc,EAAC,CAAC,WAAW,EAAE,EAAA,CAAa,EACnC,CAAE,SAAS,CAAK,CAC3B,CAAE,MAAO,EAAO,CAEZ,MADA,QAAQ,KAAK,CAAC,uBAAwB,GAChC,AAAI,MAAM,+BACpB,CACJ,CAIO,eAAe,EAAiB,CAAc,EACjD,GAAI,CAaA,OAZc,AAYP,MAZa,EAAA,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,CACrC,MAAO,CACH,UAAW,CACP,KAAM,CAAE,OAAQ,CAAO,CAC3B,CACJ,EACA,QAAS,CACL,UAAW,CAAE,QAAS,CAAE,MAAM,CAAK,CAAE,EACrC,SAAU,CAAE,QAAS,CAAE,UAAW,KAAM,CAAE,CAC9C,EACA,QAAS,CAAE,UAAW,MAAO,CACjC,EAEJ,CAAE,MAAO,EAAO,CAEZ,OADA,QAAQ,KAAK,CAAC,iCAAkC,GACzC,EAAE,AACb,CACJ,CAEO,eAAe,EAAmB,CAAc,CAAE,CAMxD,EACG,GAAI,CACA,IAAM,EAAU,MAAM,EAAA,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CACrC,KAAM,CACF,MAAO,EAAK,KAAK,CACjB,OAAQ,EAAK,MAAM,EAAI,OACvB,SAAU,EAAK,QAAQ,EAAI,SAC3B,UAAW,EAAK,SAAS,CACzB,QAAS,EAAK,OAAO,CACrB,UAAW,CACP,OAAQ,QAAE,CAAO,CACrB,CACJ,EACA,QAAS,CACL,UAAW,CAAE,QAAS,CAAE,MAAM,CAAK,CAAE,EACrC,SAAU,CAAE,QAAS,CAAE,UAAW,KAAM,CAAE,CAC9C,CACJ,GAGA,MADA,CAAA,EAAA,EAAA,cAAA,AAAc,EAAC,CAAC,SAAS,CAAC,EACnB,CACX,CAAE,MAAO,EAAO,CAEZ,MADA,QAAQ,KAAK,CAAC,gCAAiC,GACzC,AAAI,MAAM,qCACpB,CACJ,CAEO,eAAe,EAClB,CAAc,CACd,CAMC,EAED,GAAI,CACA,IAAM,EAAkB,CAAE,GAAG,CAAI,AAAC,CAClC,QAAO,EAAW,QAAQ,CAE1B,IAAM,EAAc,MAAM,EAAA,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CACzC,MAAO,CAAE,GAAI,CAAO,EACpB,KAAM,EACN,QAAS,CACL,UAAW,CAAE,QAAS,CAAE,MAAM,CAAK,CAAE,EACrC,SAAU,CAAE,QAAS,CAAE,UAAW,KAAM,CAAE,CAC9C,CACJ,GAGA,MADA,CAAA,EAAA,EAAA,cAAA,AAAc,EAAC,CAAC,SAAS,CAAC,EACnB,CACX,CAAE,MAAO,EAAO,CAEZ,MADA,QAAQ,KAAK,CAAC,gCAAiC,GACzC,AAAI,MAAM,0CACpB,CACJ,CAEO,eAAe,EAAmB,CAAc,EACnD,GAAI,CAMA,OALA,MAAM,EAAA,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CACrB,MAAO,CAAE,GAAI,CAAO,CACxB,GAEA,CAAA,EAAA,EAAA,cAAc,AAAd,EAAe,CAAC,SAAS,CAAC,EACnB,CAAE,SAAS,CAAK,CAC3B,CAAE,MAAO,EAAO,CAEZ,MADA,QAAQ,KAAK,CAAC,gCAAiC,GACzC,AAAI,MAAM,wCACpB,CACJ,0CAvOsB,EA4BA,EAyCA,EAiDA,EAgBA,EAqBA,EAiCA,EA+BA,IA3NA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MA4BA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MAyCA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MAiDA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MAgBA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MAqBA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MAiCA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MA+BA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,0PC9NtB,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,oBAEO,eAAe,EAAc,CAAc,CAAE,CAAmB,CAAE,CAAa,EAClF,GAAI,CACA,IAAM,EAAU,MAAM,EAAA,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC,CACxC,KAAM,QACF,QACA,EACA,aAAa,CACjB,CACJ,GAEA,MADA,CAAA,EAAA,EAAA,cAAA,AAAc,EAAC,CAAC,WAAW,EAAE,EAAA,CAAa,EACnC,CACX,CAAE,MAAO,EAAO,CAEZ,MADA,QAAQ,KAAK,CAAC,0BAA2B,GACnC,AAAI,MAAM,+BACpB,CACJ,CAEO,eAAe,EAAwB,CAAiB,CAAE,CAAmB,CAAE,CAAoB,EACtG,GAAI,CACA,IAAM,EAAU,MAAM,EAAA,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC,CACxC,MAAO,CAAE,GAAI,CAAU,EACvB,KAAM,CAAE,aAAY,CACxB,GAEA,MADA,CAAA,EAAA,EAAA,cAAA,AAAc,EAAC,CAAC,WAAW,EAAE,EAAA,CAAa,EACnC,CACX,CAAE,MAAO,EAAO,CAEZ,MADA,QAAQ,KAAK,CAAC,0BAA2B,GACnC,AAAI,MAAM,oCACpB,CACJ,CAEO,eAAe,EAAmB,CAAiB,CAAE,CAAmB,CAAE,CAAa,EAC1F,GAAI,CACA,IAAM,EAAU,MAAM,EAAA,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC,CACxC,MAAO,CAAE,GAAI,CAAU,EACvB,KAAM,OAAE,CAAM,CAClB,GAEA,MADA,CAAA,EAAA,EAAA,cAAA,AAAc,EAAC,CAAC,WAAW,EAAE,EAAA,CAAa,EACnC,CACX,CAAE,MAAO,EAAO,CAEZ,MADA,QAAQ,KAAK,CAAC,gCAAiC,GACzC,AAAI,MAAM,iDACpB,CACJ,CAEO,eAAe,EAAc,CAAiB,CAAE,CAAmB,EACtE,GAAI,CAKA,OAJA,MAAM,EAAA,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC,CACxB,MAAO,CAAE,GAAI,CAAU,CAC3B,GACA,CAAA,EAAA,EAAA,cAAA,AAAc,EAAC,CAAC,WAAW,EAAE,EAAA,CAAa,EACnC,CAAE,SAAS,CAAK,CAC3B,CAAE,MAAO,EAAO,CAEZ,MADA,QAAQ,KAAK,CAAC,0BAA2B,GACnC,AAAI,MAAM,kCACpB,CACJ,iCAxDsB,EAiBA,EAcA,EAcA,IA7CA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MAiBA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MAcA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MAcA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,0HC/CtB,IAAA,EAAA,EAAA,CAAA,CAAA,OAMO,eAAe,EAAc,CAAc,CAAE,CAAuB,CAAE,CAAuB,CAAE,CAAc,EAChH,GAAI,CACA,IAAM,EAAO,MAAM,CAAA,EAAA,EAAA,cAAA,AAAc,IACjC,GAAI,CAAC,EAAM,MAAO,CAAE,SAAS,EAAO,MAAO,cAAe,EAE1D,GAAI,CAAC,GAAmB,AAA2B,IAAI,GAAf,IAAI,GACxC,MAAO,CAAE,SAAS,EAAO,MAAO,4CAA6C,EAGjF,IAAM,EAAU,MAAM,EAAA,MAAM,CAAC,OAAO,CAAC,MAAM,CAAC,CACxC,KAAM,iBACF,WACA,SACA,EACA,KAAM,CAAE,QAAS,CAAE,GAAI,CAAO,CAAE,EAChC,KAAM,CAAE,QAAS,CAAE,GAAI,EAAK,EAAG,AAAD,CAAG,CACrC,CACJ,GAKA,MAAO,CAAE,SAAS,EAAM,KAAM,CAAQ,CAC1C,CAAE,MAAO,EAAY,CAEjB,OADA,QAAQ,KAAK,CAAC,0BAA2B,GAClC,CAAE,SAAS,EAAO,MAAO,EAAM,OAAQ,AAAD,CACjD,CACJ,CAKO,eAAe,EAAgB,CAAc,EAChD,GAAI,CAEA,GAAI,CADS,AACR,MADc,CAAA,EAAA,EAAA,cAAA,AAAc,IACtB,MAAO,CAAE,SAAS,EAAO,MAAO,cAAe,EAE1D,IAAM,EAAW,MAAM,EAAA,MAAM,CAAC,OAAO,CAAC,QAAQ,CAAC,CAC3C,MAAO,QAAE,CAAO,EAChB,QAAS,CACL,KAAM,CAAE,OAAQ,CAAE,MAAM,EAAM,OAAO,CAAK,CAAE,CAChD,EACA,QAAS,CAAE,UAAW,MAAO,EAC7B,KAAM,EACV,CADa,EAGb,MAAO,CAAE,SAAS,EAAM,KAAM,CAAS,CAC3C,CAAE,IAJ+C,EAIxC,EAAY,CAEjB,OADA,QAAQ,KAAK,CAAC,iCAAkC,GACzC,CAAE,SAAS,EAAO,MAAO,EAAM,OAAQ,AAAD,CACjD,CACJ,iCAnDsB,EAgCA,IAhCA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MAgCA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,6GCvCtB,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,oBAGO,eAAe,EAAoB,CAAmB,EACzD,GAAI,CAQA,OAPc,AAOP,MAPa,EAAA,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,CACrC,MAAO,aAAE,CAAY,EACrB,QAAS,CACL,YAAY,CAChB,EACA,QAAS,CAAE,UAAW,MAAO,CACjC,EAEJ,CAAE,MAAO,EAAO,CAEZ,OADA,QAAQ,KAAK,CAAC,wBAAyB,GAChC,EAAE,AACb,CACJ,CAGO,eAAe,EAAW,CAIhC,EACG,GAAI,CACA,IAAM,EAAO,MAAM,EAAA,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAClC,KAAM,CACF,YAAa,EAAK,WAAW,CAC7B,MAAO,EAAK,KAAK,CACjB,KAAM,EAAK,IAAI,EAAI,cACnB,OAAQ,UACZ,CACJ,GAGA,MADA,CAAA,EAAA,EAAA,cAAA,AAAc,EAAC,CAAC,WAAW,EAAE,EAAK,WAAW,CAAA,CAAE,EACxC,CACX,CAAE,MAAO,EAAO,CAEZ,MADA,QAAQ,KAAK,CAAC,uBAAwB,GAChC,AAAI,MAAM,+BACpB,CACJ,CAGO,eAAe,EAAgB,CAKrC,EACG,GAAI,CACA,IAAM,EAAK,MAAM,EAAA,MAAM,CAAC,SAAS,CAAC,MAAM,CAAC,CACrC,KAAM,CACF,OAAQ,EAAK,MAAM,CACnB,MAAO,EAAK,KAAK,CACjB,YAAa,EAAK,WAAW,CAC7B,KAAM,EAAK,IAAI,CACf,aAAc,CAClB,CACJ,GAGA,MADA,CAAA,EAAA,EAAA,cAAA,AAAc,EAAC,KACR,CACX,CAAE,MAAO,EAAO,CAEZ,MADA,QAAQ,KAAK,CAAC,qBAAsB,GAC9B,AAAI,MAAM,iCACpB,CACJ,CAGO,eAAe,EAAW,CAAU,CAAE,CAAa,CAAE,CAAmB,EAC3E,GAAI,CACA,IAAM,EAAO,MAAM,EAAA,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAClC,MAAO,IAAE,CAAG,EACZ,KAAM,OAAE,CAAM,CAClB,GAEA,MADA,CAAA,EAAA,EAAA,cAAA,AAAc,EAAC,CAAC,WAAW,EAAE,EAAA,CAAa,EACnC,CACX,CAAE,MAAO,EAAO,CAEZ,MADA,QAAQ,KAAK,CAAC,uBAAwB,GAChC,AAAI,MAAM,oCACpB,CACJ,CAGO,eAAe,EAAW,CAAU,CAAE,CAAmB,EAC5D,GAAI,CAKA,OAJA,MAAM,EAAA,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CACrB,MAAO,IAAE,CAAG,CAChB,GACA,CAAA,EAAA,EAAA,cAAA,AAAc,EAAC,CAAC,WAAW,EAAE,EAAA,CAAa,GACnC,CACX,CAAE,MAAO,EAAO,CAEZ,MADA,QAAQ,KAAK,CAAC,uBAAwB,GAChC,AAAI,MAAM,kCACpB,CACJ,CAGO,eAAe,EAAgB,CAAU,CAAE,CAKjD,EACG,GAAI,CACA,IAAM,EAAK,MAAM,EAAA,MAAM,CAAC,SAAS,CAAC,MAAM,CAAC,CACrC,MAAO,IAAE,CAAG,OACZ,CACJ,GAEA,MADA,CAAA,EAAA,EAAA,cAAA,AAAc,EAAC,KACR,CADc,AAEzB,CAAE,MAAO,EAAO,CAEZ,MADA,QAAQ,KAAK,CAAC,6BAA8B,GACtC,AAAI,EAJ2E,IAIrE,2CACpB,CACJ,CAGO,eAAe,EAAgB,CAAU,EAC5C,GAAI,CAKA,OAJA,MAAM,EAAA,MAAM,CAAC,SAAS,CAAC,MAAM,CAAC,CAC1B,MAAO,IAAE,CAAG,CAChB,GACA,CAAA,EAAA,EAAA,cAAc,AAAd,EAAe,MACR,CACX,CAAE,MAAO,EAAO,CAEZ,MADA,QAAQ,KAAK,CAAC,6BAA8B,GACtC,AAAI,MAAM,yCACpB,CACJ,iCA/HsB,EAiBA,EAwBA,EA0BA,EAeA,EAcA,EAoBA,IApHA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MAiBA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MAwBA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MA0BA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MAeA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MAcA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MAoBA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,gLCvHtB,IAAA,EAAA,EAAA,CAAA,CAAA,OAEA,EAAA,EAAA,CAAA,CAAA,OAKO,eAAe,EAAW,CAAkB,CAAE,CAA+B,CAAE,CAAe,EACjG,GAAI,CACA,IAAM,EAAS,MAAM,CAAA,EAAA,EAAA,cAAA,AAAc,IACnC,GAAI,CAAC,EAAQ,MAAO,CAAE,SAAS,EAAO,MAAO,cAAe,EAE5D,GAAI,CAAC,GAA8B,IAAI,CAAvB,EAAQ,IAAI,GACxB,MAAO,CAAE,SAAS,EAAO,MAAO,iCAAkC,EAGtE,GAAI,EAAO,EAAE,GAAK,EACd,MAAO,CAAE,GADiB,MACR,EAAO,MAAO,mCAAoC,EAGxE,IAAM,EAAO,MAAM,EAAA,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAClC,KAAM,SACF,EACA,OAAQ,GACR,SAAU,EAAO,EAAE,YACnB,cACA,CACJ,CACJ,GAGM,EAAQ,CAAC,iBAAiB,CAAC,CAC3B,EAAO,CAAC,CAAC,EAAE,EAAO,IAAI,EAAI,EAAO,KAAK,CAAC,oBAAoB,EAAE,EAAA,CAAS,CACtE,EAAM,EAAc,CAAC,WAAW,EAAE,EAAA,CAAa,CAAG,YASxD,OAPA,MAAM,CAAA,EAAA,EAAA,sBAAA,AAAsB,EAAC,EAAY,EAAO,EAAM,GAElD,GACA,CAAA,EAAA,EAAA,KADa,SACb,AAAc,EAAC,CAAC,WAAW,EAAE,EAAA,CAAa,EAE9C,CAAA,EAAA,EAAA,cAAc,AAAd,EAAe,KAER,CAFc,AAEZ,SAAS,EAAM,KAAM,CAAK,CACvC,CAH4C,AAG1C,MAAO,EAAY,CAEjB,OADA,QAAQ,KAAK,CAAC,uBAAwB,GAC/B,CAAE,SAAS,EAAO,MAAO,EAAM,OAAO,AAAC,CAClD,CACJ,CAKO,eAAe,EAAkB,CAAmB,EACvD,GAAI,CACA,IAAM,EAAQ,MAAM,EAAA,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,CACrC,MAAO,aAAE,CAAY,EACrB,QAAS,CACL,OAAQ,CAAE,OAAQ,CAAE,MAAM,EAAM,OAAO,CAAK,CAAE,EAC9C,SAAU,CAAE,OAAQ,CAAE,MAAM,EAAM,OAAO,CAAK,CAAE,CACpD,EACA,QAAS,CAAE,UAAW,MAAO,EAC7B,KAAM,EACV,CADa,EAGb,MAAO,CAAE,SAAS,EAAM,KAAM,CAAM,CACxC,CAAE,MAAO,EAAY,CAEjB,OADA,AALyD,QAKjD,KAAK,CAAC,8BAA+B,GACtC,CAAE,SAAS,EAAO,MAAO,EAAM,OAAO,AAAC,CAClD,CACJ,CAKO,eAAe,IAClB,GAAI,CACA,IAAM,EAAQ,MAAM,EAAA,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,CACrC,QAAS,CACL,OAAQ,CAAE,OAAQ,CAAE,MAAM,EAAM,OAAO,CAAK,CAAE,EAC9C,SAAU,CAAE,OAAQ,CAAE,MAAM,EAAM,OAAO,CAAK,CAAE,EAChD,UAAW,CAAE,OAAQ,CAAE,MAAM,CAAK,CAAE,CACxC,EACA,QAAS,CAAE,UAAW,MAAO,EAC7B,KAAM,EACV,GAEA,MAAO,CAAE,SAAS,EAAM,KAAM,CAAM,CACxC,CAAE,MAAO,EAAY,CAEjB,OADA,QAAQ,KAAK,CAAC,2BAA4B,GACnC,CAAE,SAAS,EAAO,MAAO,EAAM,OAAO,AAAC,CAClD,CACJ,iCApFsB,EA6CA,EAsBA,IAnEA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MA6CA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MAsBA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA"}